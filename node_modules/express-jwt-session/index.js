var jwt = require('jsonwebtoken');
var expressJwt = require('express-jwt');
var compose = require('composable-middleware');

/**
 * Attaches the user object to the request if authenticated
 * Otherwise returns 403
 */

function isAuthenticated(secret) {
     return expressJwt({ secret: secret }); 
}


/**
 * Returns a jwt token signed by the app secret
 * user: { _id: user._id, email: user.email, role: user.role}
 */
function signToken(user, secret, sessionTimout) {
  return jwt.sign(user, secret, { expiresIn: sessionTimout});
}


module.exports = {
	isAuthenticated : isAuthenticated,
	signToken : signToken
}